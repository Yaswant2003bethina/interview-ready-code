
{% extends "base.html" %}

{% block title %}Student Dashboard{% endblock %}

{% block content %}
<nav class="navbar-secondary">
    <div class="nav-container">
        <div class="nav-brand">
            <h2><i class="fas fa-user-graduate"></i> Student Portal</h2>
        </div>
        <div class="nav-buttons">
            <a href="{{ url_for('student_dashboard') }}" class="nav-btn active">
                <i class="fas fa-home"></i>
                Dashboard
            </a>
            <a href="#" class="nav-btn" onclick="showProfile()">
                <i class="fas fa-user"></i>
                Profile
            </a>
            <a href="#" class="nav-btn" onclick="showSubmissions()">
                <i class="fas fa-code"></i>
                My Submissions
            </a>
            <a href="#" class="nav-btn" onclick="showLeaderboard()">
                <i class="fas fa-trophy"></i>
                Leaderboard
            </a>
        </div>
    </div>
</nav>

<div class="dashboard-container">
    <div class="dashboard-header">
        <h1><i class="fas fa-graduation-cap"></i> Student Dashboard</h1>
        <p>Welcome back, {{ session.full_name }}!</p>
    </div>
    
    <div class="modules-grid">
        {% for module in modules %}
        <div class="module-card">
            <div class="module-header">
                <h3><i class="fas fa-folder"></i> {{ module[1] }}</h3>
                <span class="problem-count">{{ module[3] }} problems</span>
            </div>
            <p class="module-description">{{ module[2] or 'No description available' }}</p>
            <a href="{{ url_for('module_problems', module_id=module[0]) }}" class="btn btn-primary">
                Start Solving <i class="fas fa-arrow-right"></i>
            </a>
        </div>
        {% endfor %}
        
        {% if not modules %}
        <div class="empty-state">
            <i class="fas fa-folder-open"></i>
            <h3>No modules available</h3>
            <p>Contact your administrator to add coding modules.</p>
        </div>
        {% endif %}
    </div>
</div>

<!-- Profile Modal -->
<div id="profileModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-user"></i> My Profile</h3>
            <span class="close" onclick="closeModal('profileModal')">&times;</span>
        </div>
        <div class="modal-body">
            <div class="profile-info">
                <p><strong>Name:</strong> {{ session.full_name }}</p>
                <p><strong>Email:</strong> {{ session.email }}</p>
                <p><strong>Role:</strong> {{ session.role.title() }}</p>
            </div>
        </div>
    </div>
</div>

<!-- Submissions Modal -->
<div id="submissionsModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-code"></i> My Submissions</h3>
            <span class="close" onclick="closeModal('submissionsModal')">&times;</span>
        </div>
        <div class="modal-body">
            <div id="submissionsList">
                <p>Loading submissions...</p>
            </div>
        </div>
    </div>
</div>

<!-- Leaderboard Modal -->
<div id="leaderboardModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-trophy"></i> Leaderboard</h3>
            <span class="close" onclick="closeModal('leaderboardModal')">&times;</span>
        </div>
        <div class="modal-body">
            <div id="leaderboardList">
                <p>Loading leaderboard...</p>
            </div>
        </div>
    </div>
</div>

<script>
function showProfile() {
    document.getElementById('profileModal').style.display = 'block';
}

function showSubmissions() {
    document.getElementById('submissionsModal').style.display = 'block';
    loadSubmissions();
}

function showLeaderboard() {
    document.getElementById('leaderboardModal').style.display = 'block';
    loadLeaderboard();
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

function loadSubmissions() {
    // This would typically fetch from an API
    document.getElementById('submissionsList').innerHTML = `
        <div class="submission-item">
            <h4>Two Sum Problem</h4>
            <span class="status accepted">Accepted</span>
            <small>Submitted 2 hours ago</small>
        </div>
        <div class="submission-item">
            <h4>Reverse String</h4>
            <span class="status wrong-answer">Wrong Answer</span>
            <small>Submitted 1 day ago</small>
        </div>
    `;
}

function loadLeaderboard() {
    // This would typically fetch from an API
    document.getElementById('leaderboardList').innerHTML = `
        <div class="leaderboard-item">
            <span class="rank">1</span>
            <span class="name">John Doe</span>
            <span class="score">450 pts</span>
        </div>
        <div class="leaderboard-item">
            <span class="rank">2</span>
            <span class="name">Jane Smith</span>
            <span class="score">420 pts</span>
        </div>
        <div class="leaderboard-item current-user">
            <span class="rank">5</span>
            <span class="name">{{ session.full_name }}</span>
            <span class="score">380 pts</span>
        </div>
    `;
}

// Close modal when clicking outside
window.onclick = function(event) {
    const modals = document.querySelectorAll('.modal');
    modals.forEach(modal => {
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });
}
</script>
{% endblock %}
